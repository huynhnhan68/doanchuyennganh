<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>ƒêang x·ª≠ l√Ω thanh to√°n...</title>
</head>
<body style="font-family:sans-serif;text-align:center;margin-top:80px">

<h2>üîÑ ƒêang x√°c nh·∫≠n thanh to√°n VNPay...</h2>
<p>Vui l√≤ng ch·ªù v√†i gi√¢y...</p>

<script>
(async () => {

  const params = new URLSearchParams(location.search);

  // G·ªçi API ƒë·ªÉ x·ª≠ l√Ω IPN ph√≠a server
  const apiURL = "https://doanchuyennganh-v2py.vercel.app/api/vnpay_ipn";

  const res = await fetch(apiURL + "?" + params.toString());
  const data = await res.json();

  console.log("IPN result:", data);

  // X·ª≠ l√Ω k·∫øt qu·∫£
  if (data.RspCode === "00") {
    alert("Thanh to√°n th√†nh c√¥ng!");
    location.href = "orders.html";
  } else {
    alert("Thanh to√°n th·∫•t b·∫°i: " + data.Message);
    location.href = "orders.html";
  }

})();
</script>

</body>
</html>
